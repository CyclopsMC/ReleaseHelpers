#!/bin/bash
# Get a parameter

if [ $# -ne 1 ]; then
    echo "Error!"
    echo "Expected arguments: cc-version [param-name]"
    exit 1
fi

name=$1

file="build.properties"
modpropfile="src/main/resources/mcmod.info"
modpropfile2="src/main/resources/META-INF/mods.toml"

if [ ! -f $file ]; then
    echo "Error!"
    echo "Can't find $file!"
    exit 1
fi

if [ ! -f $modpropfile ] && [ ! -f $modpropfile2 ]; then
    echo "Error!"
    echo "Can't find $modpropfile or $modpropfile2!"
    exit 1
fi

. $file

case $name in
    mod)
        echo $mod_version
        ;;
    minecraft)
        echo $minecraft_version
        ;;
    branch-suffix)
        echo $minecraft_version | sed "s/^\([0-9]*\)\.\([0-9]*\).*$/\1\.\2/"
        ;;
    forge)
        echo $forge_version
        ;;
    cyclops)
        echo $cyclopscore_version | sed "s/^\(.*\)-.*$/\1/"
        ;;
    modid)
        if [ ! -f $modpropfile ]; then
            gsed -n -e "s/^modId=\"\([a-z]*\)\".*$/\1/p" $modpropfile2
        else
            gsed -n -e "s/^.*\"modid\": \"\([a-z]*\)\".*$/\1/p" $modpropfile
        fi
        ;;
    *)
        echo "Can't find param $name"
        echo "All params: mod, minecraft, branch-suffix, forge, cyclops, modid"
        exit 1
        ;;
esac
